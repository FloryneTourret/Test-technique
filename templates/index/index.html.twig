{% extends 'base.html.twig' %}

{% block title %}Test technique{% endblock %}

{% block body %}
<div class="main">

    <h1> Liste d'articles</h1>
    <div class="uk-child-width-1-3@m" uk-grid uk-scrollspy="cls: uk-animation-fade; target: .uk-card; delay: 500; repeat: true"  id="list">
    </div>


    <ul class="uk-pagination uk-flex-center" uk-margin id="pagination">
    </ul>
</div>
{% endblock %}

{% block javascripts %}
<script>
var page = {{ page }}
var api_url = 'http://localhost:8008/api/v1/articles/1'
var list = document.getElementById('list')
var pagination = document.getElementById('pagination')

$.getJSON(api_url, function( data ) {
    nb_total = data.nb_total
    data = data.data

    for(var i = 0 ; i < data.length; i++)
    {
        content = '<div> \
                <a href="/article/'+ data[i]['id'] +'"> \
                    <div class="uk-card uk-card-default"> \
                        <div class="uk-card-media-top"> \
                            <img src=\'/'+data[i]['image']+'\' alt=""> \
                        </div> \
                        <div class="uk-card-body"> \
                            <h3 class="uk-card-title">'+data[i]['title']+'</h3> \
                            <p>'+data[i]['author']+'</p> \
                        </div> \
                    </div> \
                </a> \
            </div> \
        </div>'; 
        list.innerHTML += content

    }
    var content_pagination = "";
    if(page > 2)
        content_pagination += ' \
            <li><a href="/">1</a></li> \
            <li class="uk-disabled"><span>...</span></li> '
    if(page > 1)  
        content_pagination += ' \
            <li><a href="/page/'+ (parseInt(page) - 1) +'">'+ (parseInt(page) - 1) +'</a></li>'

    content_pagination += ' \
            <li class="uk-active"><span>'+ page +'</span></li>'
    if(page < nb_total)
        content_pagination += ' \
            <li><a href="/page/'+ (parseInt(page) + 1) +'">'+ (parseInt(page) + 1) +'</a></li>'
    if(parseInt(page) + 1 < nb_total)
        content_pagination += ' \
            <li class="uk-disabled"><span>...</span></li> \
            <li><a href="/page/'+ nb_total +'">'+ nb_total +'</a></li>';
    pagination.innerHTML += content_pagination
});



</script>
{% endblock %}
